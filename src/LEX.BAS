1000   'SAVE"LEX.BAS",A
1010 '-------------------------
1020 ' MSX TINY LOGO EXECUTOR
1030 '      /LEXICAL ANALYZER
1040 ' initialization module
1050 ' VRAM… ºÆ∑∂ …– ¿›ƒ≥
1060 '-------------------------
1070 '
1080 SCREEN 1,2,0
1090 WIDTH 32
1100 COLOR 15,4,7
1110 KEY OFF
1120 '
1130 '”ºﬁ ¡¨∏ºÆ∏(¿≤ƒŸ æ›÷≥)
1140 'VPOKE &H2010,&H1F 'Ä
1150 '
1160 '”ºﬁ ﬂ¿-› √≤∑ﬁ 1
1170 'FOR MI=0 TO 5
1180 '  GOSUB 5070
1190 'NEXT
1200 '
1210 '[Ä]
1220 'DATA 128
1230 'DATA 00000000
1240 'DATA 00000001
1250 'DATA 00000011
1260 'DATA 00000111
1270 'DATA 00001111
1280 'DATA 00011111
1290 'DATA 00111111
1300 'DATA 01111111
1310 '[Å]
1320 'DATA 129
1330 'DATA 11111110
1340 'DATA 11111100
1350 'DATA 11111000
1360 'DATA 11110000
1370 'DATA 11100000
1380 'DATA 11000000
1390 'DATA 10000000
1400 'DATA 00000000
1410 '[Ç]
1420 'DATA 130
1430 'DATA 00000000
1440 'DATA 10000000
1450 'DATA 11000000
1460 'DATA 11100000
1470 'DATA 11110000
1480 'DATA 11111000
1490 'DATA 11111100
1500 'DATA 11111110
1510 '[É]
1520 'DATA 131
1530 'DATA 01111111
1540 'DATA 00111111
1550 'DATA 00011111
1560 'DATA 00001111
1570 'DATA 00000111
1580 'DATA 00000011
1590 'DATA 00000001
1600 'DATA 00000000
1610 '[Ñ]
1620 'DATA 132
1630 'DATA 11111111
1640 'DATA 11111111
1650 'DATA 11111111
1660 'DATA 11111111
1670 'DATA 11111111
1680 'DATA 11111111
1690 'DATA 11111111
1700 'DATA 11111111
1710 '[Ö]
1720 'DATA 133
1730 'DATA 00000000
1740 'DATA 00000000
1750 'DATA 00000000
1760 'DATA 00000000
1770 'DATA 00000000
1780 'DATA 00000000
1790 'DATA 00000000
1800 'DATA 00000000
1810 '
1820 '¿≤ƒŸ
1830 'FOR MI=1 TO 8
1840 '  READ MS$
1850 '  LOCATE 0,13
1860 '  PRINT MS$
1870 '  LOCATE 0,0
1880 '  '¥Ωπ∞Ãﬂº∞π›Ω ≥¥Ω∏€∞Ÿ
1890 '  PRINT CHR$(27)+"M"
1900 'NEXT
1910 'DATA " ÑÑÑÑÑÑÑÑÑÑÑÑÑÅÄÑÑÑÑÑÑÑÑÑÑÑÑÑÑÅ"
1920 'DATA " ÑÑÑÑÑÑÑÑÑÑÑÇÄÅÖÖÖÄÑÑÑÑÑÑÑÑÑÑÅÄ"
1930 'DATA " ÑÑÑÅÅÑÅÖÖÉÑÅÄÑÖÑÑÉÑÇÖÖÖÖÖÉÑÅÄÑ"
1940 'DATA " ÑÑÅÖÖÅÖÄÇÖÅÄÑÑÖÑÑÖÑÑÖÑÑÑÇÖÅÄÑÑ"
1950 'DATA " ÑÅÖÖÖÇÖÉÑÖÄÑÑÑÖÑÑÖÑÑÖÖÉÑÑÖÄÑÑÑ"
1960 'DATA " ÅÖÄÄÖÅÖÄÅÖÉÑÑÑÖÑÑÖÑÑÖÑÑÑÅÖÉÑÑÑ
1970 'DATA " ÖÄÑÑÖÖÄÅÄÇÖÖÄÑÖÑÅÖÖÄÖÖÄÅÄÇÖÖÄÑ"
1980 'DATA " ÄÑÑÑÑÑÅÄÑÑÑÑÑÑÄÑÑÑÑÑÑÑÅÄÑÑÑÑÑÑ"
1990 LOCATE 7,11
2000 PRINT"     MSX T-LEX"
2010 LOCATE 7,14
2020 PRINT"TINY lOGO exECUTOR"
2030 LOCATE 7,15
2040 PRINT" /lexICAL ANALYZER"
2050 PRINT
2060 '
2070 'ª›ÃﬂŸ √∑Ωƒ
2080 FOR I=32 TO 253
2090   IF I=127 THEN PRINT"\"; ELSE PRINT CHR$(I);
2100 ' IF (I MOD 24)=23 THEN PRINT
2110 NEXT
2120 '
2130 'ΩÃﬂ◊≤ƒ √≤∑ﬁ
2140 FOR MI=0 TO 2
2150   MS$=""
2160   MT$=""
2170   FOR MJ=0 TO 15
2180     READ MA$
2190     MS$=MS$+CHR$(VAL("&b"+LEFT$(MA$,8)))
2200     MT$=MT$+CHR$(VAL("&b"+RIGHT$(MA$,8)))
2210   NEXT
2220   SPRITE$(MI)=MS$+MT$
2230 NEXT
2240 '
2250 'œ≥Ω∂-øŸ
2260 DATA 1000000000000000
2270 DATA 1100000000000000
2280 DATA 1100000000000000
2290 DATA 1110000000000000
2300 DATA 1110000000000000
2310 DATA 1111000000000000
2320 DATA 1111000000000000
2330 DATA 1111100000000000
2340 DATA 1110000000000000
2350 DATA 0000000000000000
2360 DATA 0000000000000000
2370 DATA 0000000000000000
2380 DATA 0000000000000000
2390 DATA 0000000000000000
2400 DATA 0000000000000000
2410 DATA 0000000000000000
2420 '
2430 'Ω≈ƒﬁπ≤
2440 DATA 1111111110000000
2450 DATA 1000011110000000
2460 DATA 1000111110000000
2470 DATA 0100111100000000
2480 DATA 0100111100000000
2490 DATA 0010111000000000
2500 DATA 0001110000000000
2510 DATA 0001110000000000
2520 DATA 0010111000000000
2530 DATA 0101111100000000
2540 DATA 0101111100000000
2550 DATA 1011111110000000
2560 DATA 1011111110000000
2570 DATA 1111111110000000
2580 DATA 0000000000000000
2590 DATA 0000000000000000
2600 '
2610 '∑∞Œﬁ∞ƒﬁø≥ª÷≥ ∂∞øŸ
2620 DATA 0011000000000000
2630 DATA 0011100000000000
2640 DATA 0011110000000000
2650 DATA 0011100000000000
2660 DATA 0011000000000000
2670 DATA 0000000000000000
2680 DATA 0000000000000000
2690 DATA 0000000000000000
2700 DATA 0000000000000000
2710 DATA 0000000000000000
2720 DATA 0000000000000000
2730 DATA 0000000000000000
2740 DATA 0000000000000000
2750 DATA 0000000000000000
2760 DATA 0000000000000000
2770 DATA 0000000000000000
2780 '
2790 '”ºﬁ ﬂ¿-› √≤∑ﬁ2
2800 FOR MI=0 TO 14
2810   GOSUB 5190
2820 NEXT
2830 '
2840 '[?]:X
2850 DATA 63
2860 DATA 00111000
2870 DATA 01000100
2880 DATA 01000100
2890 DATA 00001000
2900 DATA 00010000
2910 DATA 00000000
2920 DATA 00010000
2930 DATA 00000000
2940 '[`]:X
2950 DATA 96
2960 DATA 01111111
2970 DATA 11111111
2980 DATA 11111111
2990 DATA 11111111
3000 DATA 11111111
3010 DATA 11111111
3020 DATA 01111111
3030 DATA 00011100
3040 '{
3050 DATA 123
3060 DATA 11111100
3070 DATA 11111000
3080 DATA 11110000
3090 DATA 11110000
3100 DATA 11110000
3110 DATA 11111000
3120 DATA 11111100
3130 DATA 00000000
3140 '[|]:V
3150 DATA 124
3160 DATA 00011100
3170 DATA 00011100
3180 DATA 00011100
3190 DATA 00011100
3200 DATA 00011100
3210 DATA 00011100
3220 DATA 00011100
3230 DATA 00011100
3240 '}
3250 DATA 125
3260 DATA 01111111
3270 DATA 00111111
3280 DATA 00011111
3290 DATA 00011111
3300 DATA 00011111
3310 DATA 00111111
3320 DATA 01111111
3330 DATA 00000000
3340 '[~]:Z
3350 DATA 126
3360 DATA 01111111
3370 DATA 11111111
3380 DATA 11111111
3390 DATA 11111111
3400 DATA 11111111
3410 DATA 11111111
3420 DATA 01111111
3430 DATA 00000000
3440 'ﬁ
3450 DATA 222
3460 DATA 10100000
3470 DATA 01010000
3480 DATA 01010000
3490 DATA 00000000
3500 DATA 00000000
3510 DATA 00000000
3520 DATA 00000000
3530 DATA 00000000
3540 '}
3550 'P=~
3560 DATA 16
3570 DATA 00000000
3580 DATA 00111000
3590 DATA 00000000
3600 DATA 00000000
3610 DATA 00000000
3620 DATA 00000000
3630 DATA 00000000
3640 DATA 00000000
3650 'V
3660 DATA 22
3670 DATA 00011000
3680 DATA 00011000
3690 DATA 00011000
3700 DATA 00011000
3710 DATA 00011000
3720 DATA 00011000
3730 DATA 00011000
3740 DATA 00011000
3750 'W
3760 DATA 23
3770 DATA 00000000
3780 DATA 00000000
3790 DATA 00000000
3800 DATA 11111111
3810 DATA 11111111
3820 DATA 00000000
3830 DATA 00000000
3840 DATA 00000000
3850 'X
3860 DATA 24
3870 DATA 00000000
3880 DATA 00000000
3890 DATA 00000000
3900 DATA 00000001
3910 DATA 00000111
3920 DATA 00001111
3930 DATA 00001100
3940 DATA 00011100
3950 'Y
3960 DATA 25
3970 DATA 00000000
3980 DATA 00000000
3990 DATA 00000000
4000 DATA 10000000
4010 DATA 11100000
4020 DATA 11110000
4030 DATA 00110000
4040 DATA 00111000
4050 'Z
4060 DATA 26
4070 DATA 00011100
4080 DATA 00001100
4090 DATA 00001111
4100 DATA 00000111
4110 DATA 00000001
4120 DATA 00000000
4130 DATA 00000000
4140 DATA 00000000
4150 '[
4160 DATA 27
4170 DATA 00111000
4180 DATA 00110000
4190 DATA 11110000
4200 DATA 11100000
4210 DATA 10000000
4220 DATA 00000000
4230 DATA 00000000
4240 DATA 00000000
4250 'Ñ=Ãﬁ€Ø∏ ¿ﬁ∏√›
4260 DATA 132
4270 DATA 11111111
4280 DATA 01011111
4290 DATA 10101111
4300 DATA 10101111
4310 DATA 11111111
4320 DATA 11111111
4330 DATA 11111111
4340 DATA 00000000
4350 '
4360 'Ã´›ƒ ∂∫≥
4370 '
4380 MF=0 'œΩ∏
4390 '
4400 '–∑ﬁ ºÃƒ
4410 FOR MI=ASC(".")*8 TO ASC("/")*8+7
4420   VPOKE MI,VPEEK(MI)\2
4430 NEXT
4440 FOR MI=ASC(";")*8 TO ASC(";")*8+7
4450   VPOKE MI,VPEEK(MI)\2
4460 NEXT
4470 '”ºﬁ ¶ ±Øº≠∏(ºﬁÆ≥πﬁ2◊≤›)
4480 FOR MI=ASC("!") TO ASC("+")
4490   GOSUB 5270
4500 NEXT
4510 FOR MI=ASC("0") TO ASC(":")
4520   GOSUB 5270
4530 NEXT
4540 FOR MI=ASC("<") TO ASC(">")
4550   GOSUB 5270
4560 NEXT
4570 FOR MI=ASC("@") TO ASC("Z")
4580   GOSUB 5270
4590 NEXT
4600 '
4610 '∫”ºﬁ ¶ µµ”ºﬁ∂ & Ãﬁ€Ø∏∂
4620 MF=255 '”ºﬁ ﬂ¿-›  ›√›(Ãﬁ€Ø∏∂)
4630 FOR MI=ASC("a") TO ASC("z")
4640   VPOKE MI*8+0,MF XOR 0
4650   VPOKE MI*8+1,MF XOR VPEEK((MI-32)*8+1)
4660   VPOKE MI*8+2,MF XOR VPEEK((MI-32)*8+2)
4670   VPOKE MI*8+3,MF XOR VPEEK((MI-32)*8+3)
4680   VPOKE MI*8+4,MF XOR VPEEK((MI-32)*8+4)
4690   VPOKE MI*8+5,MF XOR VPEEK((MI-32)*8+5)
4700   VPOKE MI*8+6,MF XOR 0
4710   VPOKE MI*8+7,0
4720 NEXT
4730 '
4740 '∂¿∂≈… À◊∂ﬁ≈∂&À◊∂ﬁ≈…  ›√›
4750 FOR MI=ASC("Ü")*8 TO ASC("ü")*8+7
4760   IF ASC("è")*8+7<MI AND MI<ASC("ë")*8 THEN 4800
4770   MF=VPEEK(MI)\2
4780   VPOKE MI+256,MF
4790   IF(MI MOD 8)<7 THEN VPOKE MI,255 XOR MF
4800 NEXT
4810 FOR MI=ASC("‡")*8 TO ASC("˝")*8+7
4820   MF=VPEEK(MI)\2
4830   VPOKE MI-256,MF
4840   IF(MI MOD 8)<7 THEN VPOKE MI,255 XOR MF
4850 NEXT
4860 COLOR 14,15,14
4870 '
4880 '”ºﬁ ¡¨∏ºÆ∏
4890 VPOKE &H2001,&H2F 'π≤æ›
4900 VPOKE &H2002,&H2F 'π≤æ›
4910 VPOKE &H2003,&H2F 'π≤æ›
4920 VPOKE &H2006,&HDF '0
4930 VPOKE &H2007,&HDF '8
4940 VPOKE &H2008,&H6F '@
4950 VPOKE &H2009,&H6F 'H
4960 VPOKE &H200A,&H6F 'P
4970 VPOKE &H200B,&H6F 'X
4980 VPOKE &H200C,&H5F '`a
4990 VPOKE &H200D,&H5F 'h
5000 VPOKE &H200E,&H5F 'p
5010 VPOKE &H200F,&H5F 'x
5020 VPOKE &H2010,&H5F 'Ü
5030 VPOKE &H2011,&H5F 'à
5040 VPOKE &H2012,&H5F 'ë
5050 VPOKE &H2013,&H5F 'ò
5060 VPOKE &H201C,&H5F '‡
5070 VPOKE &H201D,&H5F 'Ë
5080 VPOKE &H201E,&H5F '
5090 VPOKE &H201F,&H5F '¯
5100 'Ãﬁ€Ø∏÷≥ ¿ﬁ∏√›
5110 'VPOKE ASC("Ñ")*8+0,&H5F
5120 'VPOKE ASC("Ñ")*8+1,&HAF
5130 'VPOKE ASC("Ñ")*8+2,&HAF
5140 'VPOKE ASC("Ñ")*8+7,&H0
5150 '“≤› Ãﬂ€∏ﬁ◊— … ºﬁØ∫≥
5160 RUN"lex-main.bas"
5170 END
5180 '
5190 '”ºﬁ ﬂ¿-› √≤∑ﬁ ªÃﬁŸ∞¡›
5200 READ MA
5210 FOR MJ=0 TO 7
5220   READ MA$
5230   VPOKE MA*8+MJ,VAL("&b"+MA$)
5240 NEXT
5250 RETURN
5260 '
5270 '”ºﬁ ±Øº≠∏ ªÃﬁŸ∞¡›
5280 VPOKE MI*8+1,(VPEEK(MI*8) OR VPEEK(MI*8+1))\2
5290 VPOKE MI*8+0,0
5300 VPOKE MI*8+2,VPEEK(MI*8+2)\2
5310 VPOKE MI*8+3,VPEEK(MI*8+3)\2
5320 VPOKE MI*8+4,VPEEK(MI*8+4)\2
5330 VPOKE MI*8+5,(VPEEK(MI*8+5) OR VPEEK(MI*8+6) OR VPEEK(MI*8+7))\2
5340 VPOKE MI*8+6,0
5350 VPOKE MI*8+7,0
5360 RETURN
